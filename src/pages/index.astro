---
import Footer from "../components/Footer.astro";
import Layout from "../layouts/Layout.astro";
import {
	dataCurrently,
	projects,
	socialLinks,
	skills,
	professionalSummary,
	careerStartDate,
} from "../data";
---

<Layout>
	<!-- =============================================
		 HERO — Vercel-style, content aligned to grid
	     ============================================= -->
	<section
		class="min-h-screen flex flex-col justify-center relative px-6 md:px-8 lg:px-16"
	>
		<!-- Hero-only grid background -->
		<div class="hero-grid">
			<div class="hero-grid-lines"></div>
			<canvas id="hero-grid-canvas" class="absolute inset-0 w-full h-full"
			></canvas>
			<div
				class="hero-grid-glow"
				style="background: radial-gradient(ellipse 60% 50% at 50% 40%, rgba(255,255,255,0.04) 0%, transparent 70%);"
			>
			</div>
		</div>

		<!-- Top metadata row — snapped to grid rhythm -->
		<div
			class="absolute top-24 left-6 md:left-8 lg:left-16 right-6 md:right-8 lg:right-16 flex justify-between items-start"
		>
			<div class="animate-reveal-in" style="animation-delay: 0.3s;">
				<p class="text-micro uppercase text-white/20 mb-1">Role</p>
				<div id="typing-text-wrapper">
					<span id="typing-text" class="text-sm text-white/50"></span>
					<span class="text-white/20 animate-blink text-sm">|</span>
				</div>
			</div>
			<div
				class="hidden md:block text-right animate-reveal-in"
				style="animation-delay: 0.4s;"
			>
				<p class="text-micro uppercase text-white/20 mb-1">Based in</p>
				<p class="text-sm text-white/50">India</p>
			</div>
		</div>

		<!-- Center Content -->
		<div class="flex flex-col items-center text-center">
			<!-- Micro label -->
			<div class="overflow-hidden mb-6">
				<p
					class="text-micro uppercase text-white/25 tracking-[0.3em] animate-reveal-up"
					style="animation-delay: 0.1s;"
				>
					Portfolio
				</p>
			</div>

			<!-- Oversized Name -->
			<div class="mb-6">
				<h1
					class="font-display font-extrabold text-display-xl uppercase leading-[0.85]"
				>
					<span class="block overflow-hidden">
						<span
							class="block animate-reveal-up"
							style="animation-delay: 0.15s;">Sarvesh</span
						>
					</span>
					<span class="block overflow-hidden">
						<span
							class="block animate-reveal-up text-neutral-600"
							style="animation-delay: 0.3s;">Rane</span
						>
					</span>
				</h1>
			</div>

			<!-- Tagline -->
			<div class="overflow-hidden mb-10">
				<p
					class="text-lg md:text-xl text-white/35 max-w-md animate-reveal-up leading-relaxed"
					style="animation-delay: 0.5s;"
				>
					Software Engineer crafting scalable backend systems and
					shipping production-grade products.
				</p>
			</div>

			<!-- Social row -->
			<div
				class="flex flex-wrap justify-center gap-5 animate-reveal-in"
				style="animation-delay: 0.6s;"
			>
				{
					socialLinks.map((social) => (
						<a
							href={social.link}
							target="_blank"
							rel="noopener noreferrer"
							class="group relative px-4 py-2 border border-white/[0.06] bg-white/[0.02] hover:bg-white/[0.06] hover:border-white/[0.12] transition-all duration-400 rounded-sm"
						>
							<span class="text-micro uppercase text-white/40 group-hover:text-white/80 transition-colors duration-400 tracking-wider">
								{social.title}
							</span>
						</a>
					))
				}
			</div>
		</div>

		<!-- Scroll indicator -->
		<div
			class="absolute bottom-8 left-1/2 -translate-x-1/2 animate-float"
			style="animation-delay: 1s;"
		>
			<div class="flex flex-col items-center gap-2">
				<span class="text-micro uppercase text-white/15 tracking-widest"
					>Scroll</span
				>
				<div
					class="w-px h-8 bg-gradient-to-b from-white/20 to-transparent"
				>
				</div>
			</div>
		</div>
	</section>

	<!-- =============================================
		 HORIZONTAL DIVIDER with grid-aligned marks
	     ============================================= -->
	<div class="relative px-6 md:px-8 lg:px-16">
		<div class="h-px bg-white/[0.06] w-full reveal"></div>
	</div>

	<!-- =============================================
		 MARQUEE — Horizontal scrolling text
	     ============================================= -->
	<div class="marquee-wrapper overflow-hidden py-5 reveal">
		<div class="marquee-container">
			<div class="marquee-content">
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Software Engineer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Backend Developer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">DevOps Enthusiast</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Software Engineer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Backend Developer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">DevOps Enthusiast</span>
				<span class="text-white/5">&mdash;</span>
			</div>
			<div class="marquee-content" aria-hidden="true">
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Software Engineer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Backend Developer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">DevOps Enthusiast</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Software Engineer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">Backend Developer</span>
				<span class="text-white/5">&mdash;</span>
				<span class="text-micro uppercase text-white/8 tracking-[0.3em] mx-8">DevOps Enthusiast</span>
				<span class="text-white/5">&mdash;</span>
			</div>
		</div>
	</div>

	<div class="relative px-6 md:px-8 lg:px-16">
		<div class="h-px bg-white/[0.06] w-full reveal"></div>
	</div>

	<!-- =============================================
		 PROJECTS — Editorial list, Vercel-clean
	     ============================================= -->
	<section
		id="work-section"
		class="py-24 md:py-40 px-6 md:px-8 lg:px-16 scroll-mt-20"
	>
		<div
			class="mb-20 flex flex-col md:flex-row md:items-end justify-between gap-6"
		>
			<div>
				<p class="text-micro uppercase text-white/20 mb-4 reveal">
					Selected Work
				</p>
				<h2
					class="font-display font-extrabold text-display-lg uppercase reveal stagger-1"
				>
					Featured<br />Projects
				</h2>
			</div>
			<p
				class="text-base md:text-lg text-white/35 max-w-sm leading-relaxed reveal stagger-2"
			>
				A curated selection of projects showcasing expertise in backend
				systems, full-stack development, and software engineering.
			</p>
		</div>

		<!-- Project list -->
		<div class="flex flex-col">
			{
				projects.map((project, idx) => (
					<div
						class:list={["line-reveal", `stagger-${idx + 1}`]}
					/>
					<div
						class:list={[
							"group py-8 md:py-10 reveal",
							`stagger-${idx + 1}`,
						]}
					>
						<!-- Title, buttons, description - above image -->
						<div class="flex flex-col gap-4 mb-6">
							<!-- Title and number -->
							<div class="flex items-baseline gap-4">
								<span class="text-micro text-white/15 font-light tabular-nums">
									{String(idx + 1).padStart(2, "0")}
								</span>
								<h3 class="font-display font-bold text-display-md uppercase">
									{project.title}
								</h3>
							</div>

							<!-- Action buttons -->
							<div class="flex items-center gap-4">
								<a
									href={project.github}
									target="_blank"
									rel="noopener noreferrer"
									class="inline-flex items-center gap-2 px-4 py-2 text-sm uppercase tracking-wider text-white/50 border border-white/[0.08] bg-white/[0.02] hover:bg-white/[0.08] hover:border-white/[0.2] hover:text-white transition-all duration-300 rounded-sm"
								>
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="opacity-60 group-hover:opacity-100">
										<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
									</svg>
									<span>GitHub</span>
								</a>
								{project.live && (
									<a
										href={project.live}
										target="_blank"
										rel="noopener noreferrer"
										class="inline-flex items-center gap-2 px-4 py-2 text-sm uppercase tracking-wider text-white/50 border border-white/[0.08] bg-white/[0.02] hover:bg-white/[0.08] hover:border-white/[0.2] hover:text-white transition-all duration-300 rounded-sm"
									>
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="opacity-60 group-hover:opacity-100">
											<path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
											<polyline points="15 3 21 3 21 9"></polyline>
											<line x1="10" y1="14" x2="21" y2="3"></line>
										</svg>
										<span>Live</span>
									</a>
								)}
							</div>

							<!-- Description -->
							<p class="text-base text-white/40 max-w-xl">
								{project.description}
							</p>

							<!-- Tech Stack -->
							{project.stack && project.stack.length > 0 && (
								<div class="flex flex-wrap gap-2 mt-1">
									{project.stack.map((tech) => (
										<span class="text-xs uppercase tracking-wider text-white/30 border border-white/[0.08] bg-white/[0.02] px-3 py-1 rounded-sm">
											{tech}
										</span>
									))}
								</div>
							)}

						</div>

						<!-- Project image -->
						<div class="overflow-hidden rounded-sm border border-white/[0.06]">
							<div class="relative overflow-hidden">
								<img
									src={project.image}
									alt={`${project.title} preview`}
									class="w-full h-auto object-cover transition-transform duration-700 group-hover:scale-105"
									loading="lazy"
									onerror="this.src='/favicon.svg'; this.onerror=null;"
								/>
								<div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent pointer-events-none"></div>
							</div>
						</div>
					</div>
				))
			}
			<div class="line-reveal stagger-6"></div>
		</div>
	</section>

	<!-- =============================================
		 SKILLS — Clean grid, numbers
	     ============================================= -->
	<section class="py-24 md:py-40 px-6 md:px-8 lg:px-16">
		<div class="relative px-0 mb-20">
			<div class="h-px bg-white/[0.06] w-full mb-20 reveal"></div>
			<p class="text-micro uppercase text-white/20 mb-4 reveal">
				Capabilities
			</p>
			<h2
				class="font-display font-extrabold text-display-lg uppercase reveal stagger-1 break-words"
			>
				Skills &<br />Technologies
			</h2>
		</div>

		<div class="grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-24">
			{
				skills.map((skillGroup, groupIdx) => (
					<div class:list={["reveal", `stagger-${groupIdx + 1}`]}>
						<p class="text-micro uppercase text-white/20 mb-6 tracking-[0.2em]">
							({String(groupIdx + 1).padStart(2, "0")}){" "}
							{skillGroup.title}
						</p>
						<div class="flex flex-wrap gap-x-6 gap-y-3">
							{skillGroup.data.map((skill) => (
								<span class="text-lg md:text-xl text-white/60 hover:text-white transition-colors duration-300 cursor-default">
									{skill.title}
								</span>
							))}
						</div>
					</div>
				))
			}
		</div>
	</section>

	<!-- =============================================
		 ABOUT — Asymmetric editorial
	     ============================================= -->
	<section
		id="about-section"
		class="py-24 md:py-40 px-6 md:px-8 lg:px-16 scroll-mt-20"
	>
		<div class="h-px bg-white/[0.06] w-full mb-20 reveal"></div>

		<div class="grid grid-cols-1 md:grid-cols-12 gap-12 md:gap-8">
			<!-- Left: Image -->
			<div class="md:col-span-5 lg:col-span-4">
				<div class="reveal">
					<p class="text-micro uppercase text-white/20 mb-4">
						Profile
					</p>
					<div
						class="relative overflow-hidden border border-white/[0.06] h-96 md:h-auto"
					>
						<img
							src="/profile.webp"
							alt="Sarvesh Rane"
							class="w-full object-cover object-center aspect-[3/4] grayscale hover:grayscale-0 transition-all duration-1000"
							style="transform: rotate(90deg) scale(1.35); transform-origin: center center;"
						/>
					</div>
				</div>
				<!-- Micro details -->
				<div class="mt-6 grid grid-cols-2 gap-4 reveal stagger-2">
					<div>
						<p class="text-micro uppercase text-white/15 mb-1">
							Experience
						</p>
						<p class="text-base text-white/40">
							{
								(() => {
									const start = new Date(careerStartDate);
									const now = new Date();
									const diff =
										now.getTime() - start.getTime();
									const diffDate = new Date(diff);
									const years = Math.abs(
										diffDate.getUTCFullYear() - 1970
									);
									const months = diffDate.getUTCMonth();
									return `${years} Years ${months} Months`;
								})()
							}
						</p>
					</div>
					<div>
						<p class="text-micro uppercase text-white/15 mb-1">
							Education
						</p>
						<p class="text-base text-white/40">B.E. (EXTC)</p>
					</div>
				</div>
			</div>

			<!-- Right: About text -->
			<div
				class="md:col-span-7 lg:col-span-7 lg:col-start-6 flex flex-col justify-center"
			>
				<div class="reveal">
					<p class="text-micro uppercase text-white/20 mb-6">About</p>
					<h2
						class="font-display font-extrabold text-display-md uppercase leading-tight mb-10"
					>
						Adding, Commiting<br class="hidden md:inline" />
						and Pushing Code<br class="hidden md:inline" />
						Since 2019
					</h2>
				</div>
				<div class="line-reveal mb-8 stagger-2"></div>
				<div class="reveal stagger-3">
					<p
						class="text-lg md:text-xl text-white/50 leading-[1.9] max-w-xl"
					>
						{professionalSummary}
					</p>
				</div>
				<div class="mt-10 reveal stagger-4">
					<p class="text-micro uppercase text-white/15 mb-3">
						Alma Mater
					</p>
					<p class="text-base text-white/40">
						Smt. Kashibai Navale College of Engineering, Pune
					</p>
					<p class="text-base text-white/25 mt-1">
						Bachelor of Engineering (EXTC) w/Honors
					</p>
				</div>
			</div>
		</div>
	</section>

	<Footer />
</Layout>

<!-- Marquee animation -->
<style>
	@keyframes marquee {
		0% {
			transform: translateX(0);
		}
		100% {
			transform: translateX(-100%);
		}
	}
	.marquee-wrapper {
		width: 100%;
		position: relative;
	}
	.marquee-container {
		display: flex;
		width: max-content;
		will-change: transform;
	}
	.marquee-content {
		display: flex;
		flex-shrink: 0;
		white-space: nowrap;
		animation: marquee 20s linear infinite;
	}
</style>

<!-- Typing animation -->
<script define:vars={{ roles: dataCurrently.map((r) => r.title) }}>
	const typingEl = document.getElementById("typing-text");
	let roleIndex = 0;
	let charIndex = 0;
	let isDeleting = false;
	const typingSpeed = 70;
	const deletingSpeed = 35;
	const pauseDuration = 2500;

	function type() {
		const currentRole = roles[roleIndex];

		if (isDeleting) {
			typingEl.textContent = currentRole.substring(0, charIndex - 1);
			charIndex--;
		} else {
			typingEl.textContent = currentRole.substring(0, charIndex + 1);
			charIndex++;
		}

		let timeout = isDeleting ? deletingSpeed : typingSpeed;

		if (!isDeleting && charIndex === currentRole.length) {
			timeout = pauseDuration;
			isDeleting = true;
		} else if (isDeleting && charIndex === 0) {
			isDeleting = false;
			roleIndex = (roleIndex + 1) % roles.length;
			timeout = 500;
		}

		setTimeout(type, timeout);
	}

	setTimeout(type, 1000);
</script>

<!-- Hero grid canvas: draw crosshairs at intersections -->
<script>
	(function () {
		const canvas = document.getElementById("hero-grid-canvas");
		if (!canvas) return;
		const ctx = canvas.getContext("2d");
		const GRID = 80;
		const CROSS = 4;
		const section = canvas.closest("section");

		function resize() {
			canvas.width = section ? section.offsetWidth : window.innerWidth;
			canvas.height = section ? section.offsetHeight : window.innerHeight;
			draw();
		}

		function draw() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);
			ctx.strokeStyle = "rgba(255,255,255,0.08)";
			ctx.lineWidth = 1;
			const cols = Math.ceil(canvas.width / GRID) + 1;
			const rows = Math.ceil(canvas.height / GRID) + 1;
			for (let r = 0; r <= rows; r++) {
				for (let c = 0; c <= cols; c++) {
					const x = c * GRID;
					const y = r * GRID;
					// Fade based on distance from center
					const dx = (x / canvas.width - 0.5) * 2;
					const dy = (y / canvas.height - 0.5) * 2;
					const dist = Math.sqrt(dx * dx + dy * dy);
					const alpha = Math.max(0, 0.1 - dist * 0.06);
					if (alpha <= 0) continue;
					ctx.strokeStyle = `rgba(255,255,255,${alpha})`;
					ctx.beginPath();
					ctx.moveTo(x - CROSS, y);
					ctx.lineTo(x + CROSS, y);
					ctx.moveTo(x, y - CROSS);
					ctx.lineTo(x, y + CROSS);
					ctx.stroke();
				}
			}
		}

		resize();
		window.addEventListener("resize", resize);

		return () => {
			window.removeEventListener("resize", resize);
		};
	})();
</script>
